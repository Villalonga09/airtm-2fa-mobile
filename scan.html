<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#4a9eff">
  <title>Agregar Cuenta 2FA - Airtm</title>
  <link rel="stylesheet" href="scan.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <span class="logo-icon">ğŸ”</span>
          <div class="logo-text">
            <span class="brand">Airtm</span>
            <span class="brand-sub">2FA</span>
          </div>
        </div>
        <div class="header-title">Agregar Cuenta</div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Loading State -->
      <div id="loadingState" class="state-container">
        <div class="loader"></div>
        <p class="state-text">Verificando sesiÃ³n...</p>
      </div>

      <!-- Error State -->
      <div id="errorState" class="state-container hidden">
        <div class="error-icon">âŒ</div>
        <h2 class="error-title">SesiÃ³n InvÃ¡lida</h2>
        <p class="error-text">El cÃ³digo QR ha expirado o no es vÃ¡lido. Por favor, genera uno nuevo desde la extensiÃ³n.</p>
        <button id="retryBtn" class="btn btn-secondary">Reintentar</button>
      </div>

      <!-- Form State -->
      <div id="formState" class="state-container hidden">
        <div class="form-header">
          <div class="form-icon">ğŸ“±</div>
          <h2 class="form-title">Escanear CÃ³digo QR</h2>
          <p class="form-subtitle">Apunta tu cÃ¡mara al cÃ³digo QR TOTP</p>
        </div>

        <!-- QR Scanner Section -->
        <div class="scanner-section">
          <button type="button" id="scanQRBtn" class="btn btn-primary btn-large">
            <span class="btn-icon">ğŸ“·</span>
            Activar CÃ¡mara
          </button>
          <p class="scanner-hint">La cuenta se agregarÃ¡ automÃ¡ticamente al escanear</p>
        </div>
      </div>

      <!-- Success State -->
      <div id="successState" class="state-container hidden">
        <div class="success-animation">
          <div class="success-icon">âœ“</div>
        </div>
        <h2 class="success-title">Â¡Cuenta Agregada!</h2>
        <p class="success-text">La cuenta se ha agregado correctamente a tu extensiÃ³n. Puedes cerrar esta ventana.</p>
        <button id="closeBtn" class="btn btn-primary">Cerrar</button>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <p class="footer-text">
        <span class="footer-icon">ğŸ”’</span>
        ConexiÃ³n segura
      </p>
    </footer>
  </div>

  <!-- Camera View (Full Screen) - Estilo WhatsApp -->
  <div id="cameraView" class="camera-view hidden">
    <div class="camera-header">
      <button type="button" id="closeCameraBtn" class="btn-close-camera">
        Cancelar
      </button>
      <h3 class="camera-title">Escanea el cÃ³digo QR</h3>
    </div>
    <div class="camera-instructions">
      <p class="camera-instructions-text">Abre web.whatsapp.com, la aplicaciÃ³n de escritorio u otros dispositivos.</p>
    </div>
    <div class="camera-container">
      <div id="qrReader"></div>
    </div>
    <div class="camera-footer">
      <button type="button" class="btn-camera-action">
        Vincular con el nÃºmero de telÃ©fono
      </button>
    </div>
  </div>

  <!-- QR Scanner Library -->
  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
  <script type="module" src="scan.js"></script>
</body>
</html>
